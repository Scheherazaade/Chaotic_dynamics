 %Explicit RK4 with projection on Hamiltonian H
clear all
clc

% Get the directory path of the current MATLAB script or live script
scriptPath = mfilename('fullpath');
[scriptDir, ~, ~] = fileparts(scriptPath);

% Set the current directory to the directory of the script
cd(scriptDir);

% Start the timer
tic



h = 0.1; N = 1000-1; y0 = [5.11; pi/2; 0; 0; 3.134589909149055];
EE=0.95; LL=0.999; q=-1.7; JJ=0.4;

%here r = y(1), theta = y(2), \phi = y(3), p_r =  y(4), p_\theta = y(5) 
f =@(y) [((-2)+y(1)).*y(4).*(y(1)+(-2).*((-2)+y(1)).^(-1).*y(1).^(-2).* ...
  JJ.^2+(-1).*y(1).*((-1)+3.*cos(y(2)).^2).*((-6).*y(1).^(-4).*JJ.^2+ ...
  y(1).^(-4).*(1+y(1)).*JJ.^2+(-5/16).*((-2)+y(1)).^(-1).*y(1).^(-1) ...
  .*(JJ.^2+(-1).*q).*((-2).*(2+4.*y(1)+(-9).*y(1).^2+3.*y(1).^3)+3.*( ...
  (-2)+y(1)).^2.*y(1).^2.*log(((-2)+y(1)).^(-1).*y(1))))).^(-1);
  % theta'
  y(1).^(-2).*y(5).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).* ...
  JJ.^2+y(1).^(-4).*(1+y(1)).*JJ.^2+(-5/16).*((-2)+y(1)).^(-1).*y(1) ...
  .^(-1).*(JJ.^2+(-1).*q).*((-2).*(2+4.*y(1)+(-9).*y(1).^2+3.*y(1) ...
  .^3)+3.*((-2)+y(1)).^2.*y(1).^2.*log(((-2)+y(1)).^(-1).*y(1)))+( ...
 -5/8).*((-2)+y(1)).^(-3).*(((-2)+y(1)).*y(1).^(-1)).^(3/2).*(((-2) ...
  +y(1)).*y(1)).^(1/2).*(JJ.^2+(-1).*q).*((-2)+12.*y(1)+(-6).*y(1) ...
  .^2+3.*y(1).*(2+(-3).*y(1)+y(1).^2).*log(((-2)+y(1)).^(-1).*y(1))))).^(-1);
  %phi
   ((-2).*((-2)+y(1)).^(-1).*y(1).^(-3).*JJ.^2.*LL.*cos(2.*y(2))+((-1) ...
  +2.*y(1).^(-1)).*LL.*(1+((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*(1+y( ...
1)).*JJ.^2+(-5/16).*((-2)+y(1)).^(-1).*y(1).^(-1).*(JJ.^2+(-1).*q).* ...
((-2).*(2+4.*y(1)+(-9).*y(1).^2+3.*y(1).^3)+3.*((-2)+y(1)).^2.*y( ...
1).^2.*log(((-2)+y(1)).^(-1).*y(1)))))+(-2).*y(1).^(-1).*EE.*JJ.* ...
sin(y(2)).^2).*(y(1).^2.*(1+(-1/16).*y(1).^(-4).*((-1)+3.*cos(y(2) ...
).^2).*(16.*JJ.^2+16.*(1+y(1)).*JJ.^2+(-5).*((-2)+y(1)).^(-1).*y(1) ...
.^3.*(JJ.^2+(-1).*q).*((-2).*(2+4.*y(1)+(-9).*y(1).^2+3.*y(1).^3)+ ...
3.*((-2)+y(1)).^2.*y(1).^2.*log(((-2)+y(1)).^(-1).*y(1)))+(-10).*( ...
((-2)+y(1)).*y(1).^(-1)).^(-3/2).*y(1).*(((-2)+y(1)).*y(1)).^(1/2) ...
.*(JJ.^2+(-1).*q).*((-2)+12.*y(1)+(-6).*y(1).^2+3.*y(1).*(2+(-3).* ...
y(1)+y(1).^2).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*((-2)+y(1)) ...
.^(-1).*y(1).^(-3).*JJ.^2.*cos(2.*y(2))+((-1)+2.*y(1).^(-1)).*(1+(( ...
-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*(1+y(1)).*JJ.^2+(-5/16).*((-2)+ ...
y(1)).^(-1).*y(1).^(-1).*(JJ.^2+(-1).*q).*((-2).*(2+4.*y(1)+(-9).* ...
y(1).^2+3.*y(1).^3)+3.*((-2)+y(1)).^2.*y(1).^2.*log(((-2)+y(1)).^( ...
-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1);
 %pr'
(-1).*y(1).^(-2).*y(4).^2.*(1+(-2).*(1+(-2).*y(1).^(-1)).^( ...
  -1).*y(1).^(-4).*JJ.^2+(-1).*((-1)+3.*cos(y(2)).^2).*((-6).* ...
  y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1) ...
  ).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).^(-1)+(1/2).*(1+(-2).*y(1) ...
  .^(-1)).*y(4).^2.*(1+(-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2+(-1).*((-1)+3.*cos(y(2)).^2).*((-6).*y(1).^(-4) ...
  .*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1))))).^(-2).*(4.*(1+(-2).*y(1).^(-1)).^(-2) ...
  .*y(1).^(-6).*JJ.^2+8.*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-5) ...
  .*JJ.^2+(-1).*((-1)+3.*cos(y(2)).^2).*(23.*y(1).^(-5).*JJ.^2+( ...
  -3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y( ...
  1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+ ...
  y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1)) ...
  +3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*(( ...
  -1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))+(-1/2).*y(1).^( ...
  -2).*y(5).^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y(1).^(-5).* ...
  JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.* ...
  ((-1)+y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1) ...
  +y(1))+3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).* ...
  y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1) ...
  )).*((-1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1) ...
  .*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+ ...
  y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+ ...
  ((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1) ...
  .^(-1).*((-1).*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)).^2).^(-1).* ...
  ((-1)+y(1))+2.*((-1)+((-1)+y(1)).^2).^(-2).*((-2)+3.*((-1)+ ...
  y(1)).^2).*((-1)+y(1))+(3/2).*((-2)+y(1)).*((-1)+y(1)).*y(1) ...
  .^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1) ...
  ).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-3/2).*y(1).^(-3).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*( ...
  (-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(-1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*((-1)+y(1)).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1)))).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).^(-2)+ ...
  y(1).^(-3).*y(5).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).^(-1)+( ...
  1/2).*(LL.^2.*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4) ...
  .*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+(( ...
  -1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*((-1).*y(1).^2.*(( ...
  -1)+3.*cos(y(2)).^2).*((-5).*y(1).^(-5).*JJ.^2+(-3).*(1+y(1) ...
  .^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+y(1)).^2)+ ...
  4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1))+3.*((-1)+ ...
  y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^(-1).*((( ...
  -2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*((-1).* ...
  JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)).^2).^(-1).*((-1)+y(1))+ ...
  2.*((-1)+((-1)+y(1)).^2).^(-2).*((-2)+3.*((-1)+y(1)).^2).*(( ...
  -1)+y(1))+(3/2).*((-2)+y(1)).*((-1)+y(1)).*y(1).^(-1).*((( ...
  -2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-3/2).*y(1).^(-3).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*( ...
  (-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).* ...
  y(1).^(-2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(-1/2).*( ...
  1+(-2).*y(1).^(-1)).^(-1/2).*((-1)+y(1)).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1)))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.* ...
  ((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.* ...
  cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1) ...
  ).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+2.*y(1).*(1+( ...
  -1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1) ...
  ).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*(4.*( ...
  1+(-2).*y(1).^(-1)).^(-2).*y(1).^(-6).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+8.*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-5).*JJ.^2.*(( ...
  -1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*((-1)+3.*cos(y(2) ...
  ).^2).*((-1).*y(1).^(-5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^( ...
  -4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+ ...
  y(1)).^2).^(-2).*((-5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y( ...
  1)).^2).^(-3).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+ ...
  y(1))+(3/2).*((-2)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+( ...
  -1).*((-2)+y(1)).^(-2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+ ...
  y(1)).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*( ...
  (-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1))))+(-2).*y(1).^(-2).*(1+((-1)+3.*cos(y(2)).^2) ...
  .*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1)))))).*sin(y(2)).^2+8.*y(1).^(-3).*JJ.^2.*sin(y( ...
  2)).^4).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).* ...
  JJ.^2.*sin(y(2)).^4).^(-2)+(-4).*y(1).^(-1).*EE.*JJ.*LL.*sin( ...
  y(2)).^2.*((-1).*y(1).^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y( ...
  1).^(-5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8) ...
  .*((-1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2) ...
  .*((-5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*( ...
  (-5).*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*(( ...
  -2)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)) ...
  .^(-2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))...
+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-1)+y(1))+2.*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -2)+3.*((-1)+y(1)).^2).*((-1)+y(1))+(3/2).*((-2)+y(1)).*(( ...
  -1)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)) ...
  .^(-2).*y(1))+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*( ...
  (-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-3/2).* ...
  y(1).^(-3).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*( ...
  1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+( ...
  3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(-1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*( ...
  (-1)+y(1)).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+ ...
  y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)) ...
  .*log(((-2)+y(1)).^(-1).*y(1)))).*((-2).*(1+(-2).*y(1).^(-1) ...
  ).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.* ...
  y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y( ...
  1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q) ...
  .*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.* ...
  ((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).* ...
  sin(y(2)).^2+2.*y(1).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)...
+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+y(1).^2.*(1+(-1).*((-1) ...
  +3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1))))).*(4.*(1+(-2).*y(1).^(-1)).^(-2).*y(1).^( ...
  -6).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+8.*(1+(-2).*y(1).^(-1)).^( ...
  -1).*y(1).^(-5).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1) ...
  .^(-1)).*((-1)+3.*cos(y(2)).^2).*((-1).*y(1).^(-5).*JJ.^2+( ...
  -3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y( ...
  1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+ ...
  y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1)) ...
  +3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*(( ...
  -1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1))))+(-2).*y(1).^(-2) ...
  .*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+ ...
  8.*y(1).^(-3).*JJ.^2.*sin(y(2)).^4).*(y(1).^2.*(1+(-1).*((-1) ...
  +3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).* ...
  y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-2)+y(1).^2.*EE.^2.*(1+( ...
  -1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1) ...
  ).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).^2.*((-1).*y(1) ...
  .^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y(1).^(-5).*JJ.^2+(-3).*( ...
  1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2) ...
  .*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+y(1)) ...
  .^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1))+3.*( ...
  (-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^(-1).* ...
  (((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*((-1).* ...
  JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)).^2).^(-1).*((-1)+y(1))+ ...
  2.*((-1)+((-1)+y(1)).^2).^(-2).*((-2)+3.*((-1)+y(1)).^2).*(( ...
  -1)+y(1))+(3/2).*((-2)+y(1)).*((-1)+y(1)).*y(1).^(-1).*((( ...
  -2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-3/2).*y(1).^(-3).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*( ...
  (-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).* ...
  y(1).^(-2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(-1/2).*( ...
  1+(-2).*y(1).^(-1)).^(-1/2).*((-1)+y(1)).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1)))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.* ...
  ((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.* ...
  cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1) ...
  ).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+2.*y(1).*(1+( ...
  -1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1) ...
  ).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+...
((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*(4.*( ...
  1+(-2).*y(1).^(-1)).^(-2).*y(1).^(-6).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+8.*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-5).*JJ.^2.*(( ...
  -1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*((-1)+3.*cos(y(2) ...
  ).^2).*((-1).*y(1).^(-5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^( ...
  -4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+ ...
  y(1)).^2).^(-2).*((-5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y( ...
  1)).^2).^(-3).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+ ...
  y(1))+(3/2).*((-2)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+( ...
  -1).*((-2)+y(1)).^(-2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+ ...
  y(1)).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*( ...
  (-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1))))+(-2).*y(1).^(-2).*(1+((-1)+3.*cos(y(2)).^2) ...
  .*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1)))))).*sin(y(2)).^2+8.*y(1).^(-3).*JJ.^2.*sin(y( ...
  2)).^4).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).* ...
  JJ.^2.*sin(y(2)).^4).^(-2)+(-1).*LL.^2.*(4.*(1+(-2).*y(1).^( ...
  -1)).^(-2).*y(1).^(-6).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+8.*(1+( ...
  -2).*y(1).^(-1)).^(-1).*y(1).^(-5).*JJ.^2.*((-1)+2.*cos(y(2)) ...
  .^2)+((-1)+2.*y(1).^(-1)).*((-1)+3.*cos(y(2)).^2).*((-1).*y( ...
  1).^(-5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8) ...
  .*((-1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2) ...
  .*((-5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*( ...
  (-5).*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*(( ...
  -2)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)) ...
  .^(-2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))) ...
  +(-2).*y(1).^(-2).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1) ...
  ).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))) ...
  )).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).* ...
  JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y( ...
  1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2) ...
  .*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y( ...
  1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+( ...
  -2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1) ...
  .*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+( ...
  3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*( ...
  1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*(( ...
  1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^( ...
  -1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y( ...
  2)).^4).^(-1)+(-4).*y(1).^(-2).*EE.*JJ.*LL.*sin(y(2)).^2.*(y( ...
  1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+( ...
  1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^( ...
  -1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y( ...
  1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+ ...
  ((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1) ...
  +y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y( ...
  1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+(( ...
  -1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^( ...
  -1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))) ...
  )).*sin(y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1) ...
  +y(1).^2.*EE.^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y(1).^(-5).* ...
  JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.* ...
  ((-1)+y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1) ...
  +y(1))+3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).* ...
  y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1) ...
  )).*((-1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1) ...
  .*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+ ...
  y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+ ...
  ((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1) ...
  .^(-1).*((-1).*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)).^2).^(-1).* ...
  ((-1)+y(1))+2.*((-1)+((-1)+y(1)).^2).^(-2).*((-2)+3.*((-1)+ ...
  y(1)).^2).*((-1)+y(1))+(3/2).*((-2)+y(1)).*((-1)+y(1)).*y(1) ...
  .^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1) ...
  ).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-3/2).*y(1).^(-3).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*( ...
  (-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(-1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*((-1)+y(1)).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1)))).*sin(y(2)).^2.*(y(1).^2.*(1+(-1).*((-1)+ ...
  3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).* ...
  y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+(-2).*y(1).*EE.^2.*(1+ ...
  (-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^( ...
  -1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).^2.*(y(1).^2.*(1+ ...
  (-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^( ...
  -1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1));
% ptheta'
3.*(1+(-2).*y(1).^(-1)).*y(4).^2.*cos(y(2)).*((-6).*y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))).*(1+(-2).*(1+(-2).*y(1).^(-1)).^( ...
  -1).*y(1).^(-4).*JJ.^2+(-1).*((-1)+3.*cos(y(2)).^2).*((-6).* ...
  y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1) ...
  ).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).^(-2).*sin(y(2))+3.*y(1).^( ...
  -2).*y(5).^2.*cos(y(2)).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).* ...
  y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+( ...
  5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1)))).*(1+(-1).*((-1)+3.*cos(y(2)) ...
  .^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1))))).^(-2).*sin(y(2))+(1/2).*(8.*y(1).^(-1).*EE.*JJ.*LL.* ...
  cos(y(2)).*sin(y(2)).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)) ...
  .^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).* ...
  JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+ ...
  3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*( ...
  (-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y( ...
  1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^( ...
  -2).*JJ.^2.*sin(y(2)).^4).^(-1)+(-2).*y(1).^2.*EE.^2.*cos(y( ...
  2)).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+ ...
  y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).* ...
  ((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*( ...
  (-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).*(y(1).^2.*(1+ ...
  (-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^( ...
  -1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+(-6).* ...
  y(1).^2.*EE.^2.*cos(y(2)).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)) ...
  .*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1)))).*sin(y(2)).^3.*(y(1).^2.*(1+( ...
  -1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1) ...
  ).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+(-1).* ...
  LL.^2.*(8.*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.* ...
  cos(y(2)).*sin(y(2))+(-6).*((-1)+2.*y(1).^(-1)).*cos(y(2)).* ...
  ((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1)))).*sin(y(2))).*(y(1).^2.*(1+(-1).*((-1)+3.* ...
  cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3) ...
  .*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).* ...
  ((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y( ...
  1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+(( ...
  -1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^( ...
  -1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*(( ...
  -2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)) ...
  .^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^( ...
  -4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+( ...
  (-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).* ...
  y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+LL.^2.*((-2).*(1+(-2) ...
  .*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)) ...
  .^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y( ...
  1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*(( ...
  -1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))))).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).* ...
  JJ.^2.*sin(y(2)).^4).^(-2).*(2.*y(1).^2.*cos(y(2)).*(1+(-1).* ...
  ((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y( ...
  1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q) ...
  .*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.* ...
  ((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).* ...
  ((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).* ...
  y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+ ...
  y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y( ...
  1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)) ...
  .*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2))+( ...
  -16).*y(1).^(-2).*JJ.^2.*cos(y(2)).*sin(y(2)).^3+6.*y(1).^2.* ...
  cos(y(2)).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1) ...
  +y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+ ...
  3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1) ...
  .*y(1)))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).* ...
  JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+ ...
  3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*( ...
  (-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y( ...
  1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^3+y(1).^2.*(1+( ...
  -1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1) ...
  ).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).^2.*(8.*(1+(-2).* ...
  y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*cos(y(2)).*sin(y(2))+( ...
  -6).*((-1)+2.*y(1).^(-1)).*cos(y(2)).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))).*sin(y( ...
  2))))+(-4).*y(1).^(-1).*EE.*JJ.*LL.*sin(y(2)).^2.*(y(1).^2.*( ...
  1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^( ...
  -1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-2).*(2.*y( ...
  1).^2.*cos(y(2)).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2))+(-16).*y(1).^(-2).*JJ.^2.* ...
  cos(y(2)).*sin(y(2)).^3+6.*y(1).^2.*cos(y(2)).*(y(1).^(-4).* ...
  JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y( ...
  1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2) ...
  .*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y( ...
  1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+( ...
  -2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1) ...
  .*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+( ...
  3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))).*((-2).*( ...
  1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*(( ...
  1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^( ...
  -1).*y(1)))))).*sin(y(2)).^3+y(1).^2.*(1+(-1).*((-1)+3.*cos( ...
  y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1) ...
  +y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+ ...
  3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1) ...
  .*y(1))))).*sin(y(2)).^2.*(8.*(1+(-2).*y(1).^(-1)).^(-1).*y( ...
  1).^(-4).*JJ.^2.*cos(y(2)).*sin(y(2))+(-6).*((-1)+2.*y(1).^( ...
  -1)).*cos(y(2)).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1) ...
  ).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))).*sin(y(2))))+y(1).^2.*EE.^2.* ...
  (1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1) ...
  .^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*(( ...
  -1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).^2.*(y(1).^2.* ...
  (1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1) ...
  .^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*(( ...
  -1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^( ...
  -1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+ ...
  2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).* ...
  y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).* ...
  sin(y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-2).*( ...
  2.*y(1).^2.*cos(y(2)).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y( ...
  1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1) ...
  +((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2) ...
  .^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+ ...
  y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))) ...
  ).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*(( ...
  -1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos( ...
  y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))))).*sin(y(2))+(-16).*y(1).^(-2).* ...
  JJ.^2.*cos(y(2)).*sin(y(2)).^3+6.*y(1).^2.*cos(y(2)).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))).*((-2).* ...
  (1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos( ...
  y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*( ...
  (1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1)))))).*sin(y(2)).^3+y(1).^2.*(1+(-1).*((-1)+3.* ...
  cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3) ...
  .*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).* ...
  ((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y( ...
  1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+(( ...
  -1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^( ...
  -1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*(( ...
  -2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)) ...
  .^(-1).*y(1))))).*sin(y(2)).^2.*(8.*(1+(-2).*y(1).^(-1)).^( ...
  -1).*y(1).^(-4).*JJ.^2.*cos(y(2)).*sin(y(2))+(-6).*((-1)+2.* ...
  y(1).^(-1)).*cos(y(2)).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))).*sin(y(2)))));];

delH = @(y) [y(1).^(-2).*y(4).^2.*(1+(-2).*(1+(-2).*y(1).^(-1)).^(-1).*y( ...
  1).^(-4).*JJ.^2+(-1).*((-1)+3.*cos(y(2)).^2).*((-6).*y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1))))).^(-1)+(-1/2).*(1+(-2).*y(1).^(-1)) ...
  .*y(4).^2.*(1+(-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).* ...
  JJ.^2+(-1).*((-1)+3.*cos(y(2)).^2).*((-6).*y(1).^(-4).*JJ.^2+( ...
  1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^( ...
  -1).*y(1))))).^(-2).*(4.*(1+(-2).*y(1).^(-1)).^(-2).*y(1).^( ...
  -6).*JJ.^2+8.*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-5).*JJ.^2+( ...
  -1).*((-1)+3.*cos(y(2)).^2).*(23.*y(1).^(-5).*JJ.^2+(-3).*(1+ ...
  y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+y(1)).^2) ...
  +4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1))+3.*((-1) ...
  +y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^(-1).*((( ...
  -2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*((-1).* ...
  JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))))+(1/2).*y(1).^(-2).*y( ...
  5).^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y(1).^(-5).*JJ.^2+(-3) ...
  .*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+y( ...
  1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*(( ...
  -1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1) ...
  +y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1) ...
  .*((-1).*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)).^2).^(-1).*((-1)+ ...
  y(1))+2.*((-1)+((-1)+y(1)).^2).^(-2).*((-2)+3.*((-1)+y(1)) ...
  .^2).*((-1)+y(1))+(3/2).*((-2)+y(1)).*((-1)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))+(3/2) ...
  .*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-3/2).*y(1).^(-3).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(-1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*((-1)+y(1)).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1)))).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).^(-2)+( ...
  -1).*y(1).^(-3).*y(5).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*( ...
  y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1) ...
  ).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2) ...
  .^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+ ...
  y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))) ...
  ).^(-1)+(1/2).*((-1).*LL.^2.*((-2).*(1+(-2).*y(1).^(-1)).^( ...
  -1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1) ...
  .^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*((-1) ...
  .*y(1).^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y(1).^(-5).*JJ.^2+( ...
  -3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y( ...
  1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+ ...
  y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1)) ...
  +3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*(( ...
  -1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1) ...
  +y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1) ...
  .*((-1).*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)).^2).^(-1).*((-1)+ ...
  y(1))+2.*((-1)+((-1)+y(1)).^2).^(-2).*((-2)+3.*((-1)+y(1)) ...
  .^2).*((-1)+y(1))+(3/2).*((-2)+y(1)).*((-1)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))+(3/2) ...
  .*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-3/2).*y(1).^(-3).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(-1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*((-1)+y(1)).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1)))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+2.*y( ...
  1).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y( ...
  1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*(( ...
  -1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^( ...
  -1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+ ...
  2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).* ...
  y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).* ...
  sin(y(2)).^2+y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*(4.*( ...
  1+(-2).*y(1).^(-1)).^(-2).*y(1).^(-6).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+8.*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-5).*JJ.^2.*(( ...
  -1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*((-1)+3.*cos(y(2) ...
  ).^2).*((-1).*y(1).^(-5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^( ...
  -4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+ ...
  y(1)).^2).^(-2).*((-5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y( ...
  1)).^2).^(-3).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+ ...
  y(1))+(3/2).*((-2)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+( ...
  -1).*((-2)+y(1)).^(-2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+ ...
  y(1)).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*( ...
  (-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1))))+(-2).*y(1).^(-2).*(1+((-1)+3.*cos(y(2)).^2) ...
  .*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1)))))).*sin(y(2)).^2+8.*y(1).^(-3).*JJ.^2.*sin(y( ...
  2)).^4).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).* ...
  JJ.^2.*sin(y(2)).^4).^(-2)+4.*y(1).^(-1).*EE.*JJ.*LL.*sin(y(2) ...
  ).^2.*((-1).*y(1).^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y(1).^( ...
  -5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+ ...
  y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^( ...
  -2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+( ...
  5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-1)+y(1))+2.*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -2)+3.*((-1)+y(1)).^2).*((-1)+y(1))+(3/2).*((-2)+y(1)).*(( ...
  -1)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)) ...
  .^(-2).*y(1))+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*( ...
  (-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-3/2).* ...
  y(1).^(-3).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*( ...
  1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+( ...
  3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(-1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*( ...
  (-1)+y(1)).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+ ...
  y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)) ...
  .*log(((-2)+y(1)).^(-1).*y(1)))).*((-2).*(1+(-2).*y(1).^(-1) ...
  ).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.* ...
  y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y( ...
  1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q) ...
  .*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.* ...
  ((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).* ...
  sin(y(2)).^2+2.*y(1).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+y(1).^2.*(1+(-1).*((-1) ...
  +3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1))))).*(4.*(1+(-2).*y(1).^(-1)).^(-2).*y(1).^( ...
  -6).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+8.*(1+(-2).*y(1).^(-1)).^( ...
  -1).*y(1).^(-5).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1) ...
  .^(-1)).*((-1)+3.*cos(y(2)).^2).*((-1).*y(1).^(-5).*JJ.^2+( ...
  -3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y( ...
  1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+ ...
  y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1)) ...
  +3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*(( ...
  -1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1))))+(-2).*y(1).^(-2) ...
  .*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+ ...
  8.*y(1).^(-3).*JJ.^2.*sin(y(2)).^4).*(y(1).^2.*(1+(-1).*((-1) ...
  +3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).* ...
  y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-2)+(-1).*y(1).^2.*EE.^2.* ...
  (1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1) ...
  .^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*(( ...
  -1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).^2.*((-1).*y( ...
  1).^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y(1).^(-5).*JJ.^2+(-3) ...
  .*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5)+9.*((-1)+y( ...
  1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))).*(( ...
  -1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1) ...
  +y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1) ...
  .*((-1).*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)).^2).^(-1).*((-1)+ ...
  y(1))+2.*((-1)+((-1)+y(1)).^2).^(-2).*((-2)+3.*((-1)+y(1)) ...
  .^2).*((-1)+y(1))+(3/2).*((-2)+y(1)).*((-1)+y(1)).*y(1).^( ...
  -1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^(-2).*y(1))+(3/2) ...
  .*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-3/2).*y(1).^(-3).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(-1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*((-1)+y(1)).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1)))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+2.*y( ...
  1).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y( ...
  1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*(( ...
  -1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^( ...
  -1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+ ...
  2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).* ...
  y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).* ...
  sin(y(2)).^2+y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*(4.*( ...
  1+(-2).*y(1).^(-1)).^(-2).*y(1).^(-6).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+8.*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-5).*JJ.^2.*(( ...
  -1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*((-1)+3.*cos(y(2) ...
  ).^2).*((-1).*y(1).^(-5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^( ...
  -4).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+ ...
  y(1)).^2).^(-2).*((-5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y( ...
  1)).^2).^(-3).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+ ...
  y(1))+(3/2).*((-2)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+( ...
  -1).*((-2)+y(1)).^(-2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+ ...
  y(1)).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*( ...
  (-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1))))+(-2).*y(1).^(-2).*(1+((-1)+3.*cos(y(2)).^2) ...
  .*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1)))))).*sin(y(2)).^2+8.*y(1).^(-3).*JJ.^2.*sin(y( ...
  2)).^4).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).* ...
  JJ.^2.*sin(y(2)).^4).^(-2)+LL.^2.*(4.*(1+(-2).*y(1).^(-1)).^( ...
  -2).*y(1).^(-6).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+8.*(1+(-2).*y( ...
  1).^(-1)).^(-1).*y(1).^(-5).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+(( ...
  -1)+2.*y(1).^(-1)).*((-1)+3.*cos(y(2)).^2).*((-1).*y(1).^( ...
  -5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+ ...
  y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^( ...
  -2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1))))+( ...
  -2).*y(1).^(-2).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)) ...
  .*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))) ...
  )).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).* ...
  JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y( ...
  1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2) ...
  .*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y( ...
  1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+( ...
  -2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1) ...
  .*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+( ...
  3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*( ...
  1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*(( ...
  1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^( ...
  -1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y( ...
  2)).^4).^(-1)+4.*y(1).^(-2).*EE.*JJ.*LL.*sin(y(2)).^2.*(y(1) ...
  .^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+ ...
  y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).* ...
  ((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*( ...
  (-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^( ...
  -1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+ ...
  2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).* ...
  y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).* ...
  sin(y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+( ...
  -1).*y(1).^2.*EE.^2.*((-1)+3.*cos(y(2)).^2).*((-5).*y(1).^( ...
  -5).*JJ.^2+(-3).*(1+y(1).^(-1)).*y(1).^(-4).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5)+9.*((-1)+y(1)).^2)+4.*((-1)+((-1)+y(1)).^2).^(-3).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3).*((-1)+y(1))+(3/2).*((-2)+ ...
  y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)).^( ...
  -2).*y(1))).*((-1).*JJ.^2+q)+(5/4).*((-1)+y(1)).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+( ...
  5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-6).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-1)+y(1))+2.*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -2)+3.*((-1)+y(1)).^2).*((-1)+y(1))+(3/2).*((-2)+y(1)).*(( ...
  -1)+y(1)).*y(1).^(-1).*(((-2)+y(1)).^(-1)+(-1).*((-2)+y(1)) ...
  .^(-2).*y(1))+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(-5/4).*( ...
  (-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-3/2).* ...
  y(1).^(-3).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))+(-5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*( ...
  1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+( ...
  3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(-1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*( ...
  (-1)+y(1)).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+ ...
  y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)) ...
  .*log(((-2)+y(1)).^(-1).*y(1)))).*sin(y(2)).^2.*(y(1).^2.*( ...
  1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^( ...
  -1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+2.*y(1) ...
  .*EE.^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+ ...
  (1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2) ...
  .*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*( ...
  (-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).^2.*( ...
  y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+ ...
  (1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)) ...
  .^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*(( ...
  -5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)) ...
  .^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2) ...
  .*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*( ...
  (-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2) ...
  .*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)) ...
  .^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y( ...
  1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*(( ...
  -1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)) ...
  .^4).^(-1));
  (-3).*(1+(-2).*y(1).^(-1)).*y(4).^2.*cos(y(2)).*((-6).*y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))).*(1+(-2).*(1+(-2).*y(1).^(-1)).^( ...
  -1).*y(1).^(-4).*JJ.^2+(-1).*((-1)+3.*cos(y(2)).^2).*((-6).* ...
  y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1) ...
  ).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).^(-2).*sin(y(2))+(-3).*y(1) ...
  .^(-2).*y(5).^2.*cos(y(2)).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)) ...
  .*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1)))).*(1+(-1).*((-1)+3.*cos(y(2)) ...
  .^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1))))).^(-2).*sin(y(2))+(1/2).*((-8).*y(1).^(-1).*EE.*JJ.* ...
  LL.*cos(y(2)).*sin(y(2)).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y( ...
  2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1) ...
  ).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*( ...
  (-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).* ...
  JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+ ...
  3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*( ...
  (-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y( ...
  1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^( ...
  -2).*JJ.^2.*sin(y(2)).^4).^(-1)+2.*y(1).^2.*EE.^2.*cos(y(2)) ...
  .*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1) ...
  .^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*(( ...
  -1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).*(y(1).^2.*(1+ ...
  (-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^( ...
  -1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+6.*y(1) ...
  .^2.*EE.^2.*cos(y(2)).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y( ...
  1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q) ...
  .*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.* ...
  ((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).* ...
  ((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).* ...
  y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))).*sin(y(2)).^3.*(y(1).^2.*(1+(-1).*((-1) ...
  +3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).* ...
  y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+LL.^2.*(8.*(1+(-2).*y( ...
  1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*cos(y(2)).*sin(y(2))+(-6) ...
  .*((-1)+2.*y(1).^(-1)).*cos(y(2)).*((1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))).*sin(y( ...
  2))).*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4) ...
  .*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+ ...
  (-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1) ...
  .*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+( ...
  3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*( ...
  1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*(( ...
  1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^( ...
  -1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y( ...
  2)).^4).^(-1)+(-1).*LL.^2.*((-2).*(1+(-2).*y(1).^(-1)).^(-1) ...
  .*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^( ...
  -1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3) ...
  .*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).* ...
  ((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y( ...
  1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*(y(1).^2.*( ...
  1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^( ...
  -1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2)).^2+(-4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-2).*(2.*y( ...
  1).^2.*cos(y(2)).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+(( ...
  -1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).*((-2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.* ...
  cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)) ...
  .^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+ ...
  y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+ ...
  y(1)).^(-1).*y(1)))))).*sin(y(2))+(-16).*y(1).^(-2).*JJ.^2.* ...
  cos(y(2)).*sin(y(2)).^3+6.*y(1).^2.*cos(y(2)).*(y(1).^(-4).* ...
  JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y( ...
  1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2) ...
  .*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y( ...
  1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+( ...
  -2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1) ...
  .*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+( ...
  3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1)))).*((-2).*( ...
  1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y( ...
  2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*(( ...
  1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5) ...
  .*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^( ...
  -1).*y(1)))))).*sin(y(2)).^3+y(1).^2.*(1+(-1).*((-1)+3.*cos( ...
  y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1) ...
  +y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+ ...
  3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1) ...
  .*y(1))))).*sin(y(2)).^2.*(8.*(1+(-2).*y(1).^(-1)).^(-1).*y( ...
  1).^(-4).*JJ.^2.*cos(y(2)).*sin(y(2))+(-6).*((-1)+2.*y(1).^( ...
  -1)).*cos(y(2)).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*(( ...
  -1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1) ...
  ).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))).*sin(y(2))))+4.*y(1).^(-1).* ...
  EE.*JJ.*LL.*sin(y(2)).^2.*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y( ...
  2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1) ...
  ).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*(( ...
  -1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*( ...
  (-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).* ...
  JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+ ...
  3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*( ...
  (-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y( ...
  1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^( ...
  -2).*JJ.^2.*sin(y(2)).^4).^(-2).*(2.*y(1).^2.*cos(y(2)).*(1+( ...
  -1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1) ...
  ).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2))+(-16).*y(1).^(-2).*JJ.^2.*cos(y(2)).*sin(y(2)).^3+6.*y( ...
  1).^2.*cos(y(2)).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1)))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^3+y(1) ...
  .^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+ ...
  y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).* ...
  ((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*( ...
  (-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).^2.*(8.*(1+( ...
  -2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*cos(y(2)).*sin(y( ...
  2))+(-6).*((-1)+2.*y(1).^(-1)).*cos(y(2)).*((1+y(1).^(-1)).* ...
  y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))).* ...
  sin(y(2))))+(-1).*y(1).^2.*EE.^2.*(1+(-1).*((-1)+3.*cos(y(2) ...
  ).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1))))).*sin(y(2)).^2.*(y(1).^2.*(1+(-1).*((-1)+3.*cos(y(2)) ...
  .^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)) ...
  .^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1) ...
  .*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*(( ...
  -1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y( ...
  1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).* ...
  JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+ ...
  3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*( ...
  (-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y( ...
  1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^( ...
  -2).*JJ.^2.*sin(y(2)).^4).^(-2).*(2.*y(1).^2.*cos(y(2)).*(1+( ...
  -1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1) ...
  ).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).* ...
  JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y( ...
  1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+ ...
  (5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^( ...
  -1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)) ...
  .^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).* ...
  log(((-2)+y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)) ...
  .^(-1).*y(1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y( ...
  1).^(-1)).*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin( ...
  y(2))+(-16).*y(1).^(-2).*JJ.^2.*cos(y(2)).*sin(y(2)).^3+6.*y( ...
  1).^2.*cos(y(2)).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1)))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^3+y(1) ...
  .^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+ ...
  y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).* ...
  ((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*( ...
  (-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).* ...
  y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^( ...
  -1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1) ...
  +y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1) ...
  ).*log(((-2)+y(1)).^(-1).*y(1))))).*sin(y(2)).^2.*(8.*(1+( ...
  -2).*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2.*cos(y(2)).*sin(y( ...
  2))+(-6).*((-1)+2.*y(1).^(-1)).*cos(y(2)).*((1+y(1).^(-1)).* ...
  y(1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+ ...
  q).*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+ ...
  3.*((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))).* ...
  sin(y(2)))));
0;
((-2)+y(1)).*y(4).*(y(1)+(-2).*((-2)+y(1)).^(-1).*y(1).^(-2) ...
  .*JJ.^2+(-1).*y(1).*((-1)+3.*cos(y(2)).^2).*((-6).*y(1).^(-4) ...
  .*JJ.^2+y(1).^(-4).*(1+y(1)).*JJ.^2+(-5/16).*((-2)+y(1)).^(-1) ...
  .*y(1).^(-1).*(JJ.^2+(-1).*q).*((-2).*(2+4.*y(1)+(-9).*y(1) ...
  .^2+3.*y(1).^3)+3.*((-2)+y(1)).^2.*y(1).^2.*log(((-2)+y(1)) ...
  .^(-1).*y(1))))).^(-1);
y(1).^(-2).*y(5).*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1).^( ...
  -4).*JJ.^2+y(1).^(-4).*(1+y(1)).*JJ.^2+(-5/16).*((-2)+y(1)).^( ...
  -1).*y(1).^(-1).*(JJ.^2+(-1).*q).*((-2).*(2+4.*y(1)+(-9).*y( ...
  1).^2+3.*y(1).^3)+3.*((-2)+y(1)).^2.*y(1).^2.*log(((-2)+y(1) ...
  ).^(-1).*y(1)))+(-5/8).*((-2)+y(1)).^(-3).*(((-2)+y(1)).*y( ...
  1).^(-1)).^(3/2).*(((-2)+y(1)).*y(1)).^(1/2).*(JJ.^2+(-1).*q) ...
  .*((-2)+12.*y(1)+(-6).*y(1).^2+3.*y(1).*(2+(-3).*y(1)+y(1) ...
  .^2).*log(((-2)+y(1)).^(-1).*y(1))))).^(-1)];



He=(1/2)+(1/2).*(1+(-2).*y0(1).^(-1)).*y0(4).^2.*(1+(-2).*(1+(-2) ...
  .*y0(1).^(-1)).^(-1).*y0(1).^(-4).*JJ.^2+(-1).*((-1)+3.*cos(y0( ...
  2)).^2).*((-6).*y0(1).^(-4).*JJ.^2+(1+y0(1).^(-1)).*y0(1).^(-3) ...
  .*JJ.^2+(5/8).*((-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q).*((-1).* ...
  ((-1)+((-1)+y0(1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.*((-1)+y0( ...
  1)).^3)+(3/2).*log(((-2)+y0(1)).^(-1).*y0(1))))).^(-1)+(1/2).* ...
  y0(1).^(-2).*y0(5).^2.*(1+(-1).*((-1)+3.*cos(y0(2)).^2).*(y0(1) ...
  .^(-4).*JJ.^2+(1+y0(1).^(-1)).*y0(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y0(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y0(1)).^2) ...
  .^(-2).*((-5).*((-1)+y0(1))+3.*((-1)+y0(1)).^3)+(3/2).*log((( ...
  -2)+y0(1)).^(-1).*y0(1)))+(5/4).*((-1)+((-1)+y0(1)).^2).^(1/2) ...
  .*(1+(-2).*y0(1).^(-1)).^(-1/2).*y0(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y0(1)).^2).^(-1).*((-2)+3.*((-1)+y0(1)).^2) ...
  +(3/2).*((-1)+y0(1)).*log(((-2)+y0(1)).^(-1).*y0(1))))).^(-1)+( ...
  1/2).*(LL.^2.*((-2).*(1+(-2).*y0(1).^(-1)).^(-1).*y0(1).^(-4) ...
  .*JJ.^2.*((-1)+2.*cos(y0(2)).^2)+((-1)+2.*y0(1).^(-1)).*(1+(( ...
  -1)+3.*cos(y0(2)).^2).*((1+y0(1).^(-1)).*y0(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y0(1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.*((-1)+y0(1)).^3)+( ...
  3/2).*log(((-2)+y0(1)).^(-1).*y0(1)))))).*(y0(1).^2.*(1+(-1).*( ...
  (-1)+3.*cos(y0(2)).^2).*(y0(1).^(-4).*JJ.^2+(1+y0(1).^(-1)).*y0( ...
  1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q) ...
  .*((-1).*((-1)+((-1)+y0(1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.* ...
  ((-1)+y0(1)).^3)+(3/2).*log(((-2)+y0(1)).^(-1).*y0(1)))+(5/4).* ...
  ((-1)+((-1)+y0(1)).^2).^(1/2).*(1+(-2).*y0(1).^(-1)).^(-1/2).* ...
  y0(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y0(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y0(1)).^2)+(3/2).*((-1)+y0(1)).*log(((-2)+ ...
  y0(1)).^(-1).*y0(1))))).*((-2).*(1+(-2).*y0(1).^(-1)).^(-1).*y0( ...
  1).^(-4).*JJ.^2.*((-1)+2.*cos(y0(2)).^2)+((-1)+2.*y0(1).^(-1)) ...
  .*(1+((-1)+3.*cos(y0(2)).^2).*((1+y0(1).^(-1)).*y0(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y0(1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.*((-1)+y0(1)) ...
  .^3)+(3/2).*log(((-2)+y0(1)).^(-1).*y0(1)))))).*sin(y0(2)).^2+( ...
  -4).*y0(1).^(-2).*JJ.^2.*sin(y0(2)).^4).^(-1)+(-4).*y0(1).^(-1) ...
  .*EE.*JJ.*LL.*sin(y0(2)).^2.*(y0(1).^2.*(1+(-1).*((-1)+3.*cos( ...
  y0(2)).^2).*(y0(1).^(-4).*JJ.^2+(1+y0(1).^(-1)).*y0(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y0(1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.*((-1)+y0(1)) ...
  .^3)+(3/2).*log(((-2)+y0(1)).^(-1).*y0(1)))+(5/4).*((-1)+((-1) ...
  +y0(1)).^2).^(1/2).*(1+(-2).*y0(1).^(-1)).^(-1/2).*y0(1).^(-1) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y0(1)).^2).^(-1).*((-2)+ ...
  3.*((-1)+y0(1)).^2)+(3/2).*((-1)+y0(1)).*log(((-2)+y0(1)).^(-1) ...
  .*y0(1))))).*((-2).*(1+(-2).*y0(1).^(-1)).^(-1).*y0(1).^(-4).* ...
  JJ.^2.*((-1)+2.*cos(y0(2)).^2)+((-1)+2.*y0(1).^(-1)).*(1+((-1)+ ...
  3.*cos(y0(2)).^2).*((1+y0(1).^(-1)).*y0(1).^(-3).*JJ.^2+(5/8).*( ...
  (-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y0( ...
  1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.*((-1)+y0(1)).^3)+(3/2).* ...
  log(((-2)+y0(1)).^(-1).*y0(1)))))).*sin(y0(2)).^2+(-4).*y0(1).^( ...
  -2).*JJ.^2.*sin(y0(2)).^4).^(-1)+y0(1).^2.*EE.^2.*(1+(-1).*(( ...
  -1)+3.*cos(y0(2)).^2).*(y0(1).^(-4).*JJ.^2+(1+y0(1).^(-1)).*y0(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y0(1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.*(( ...
  -1)+y0(1)).^3)+(3/2).*log(((-2)+y0(1)).^(-1).*y0(1)))+(5/4).*(( ...
  -1)+((-1)+y0(1)).^2).^(1/2).*(1+(-2).*y0(1).^(-1)).^(-1/2).*y0( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y0(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y0(1)).^2)+(3/2).*((-1)+y0(1)).*log(((-2)+y0( ...
  1)).^(-1).*y0(1))))).*sin(y0(2)).^2.*(y0(1).^2.*(1+(-1).*((-1)+ ...
  3.*cos(y0(2)).^2).*(y0(1).^(-4).*JJ.^2+(1+y0(1).^(-1)).*y0(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y0(1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.*(( ...
  -1)+y0(1)).^3)+(3/2).*log(((-2)+y0(1)).^(-1).*y0(1)))+(5/4).*(( ...
  -1)+((-1)+y0(1)).^2).^(1/2).*(1+(-2).*y0(1).^(-1)).^(-1/2).*y0( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y0(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y0(1)).^2)+(3/2).*((-1)+y0(1)).*log(((-2)+y0( ...
  1)).^(-1).*y0(1))))).*((-2).*(1+(-2).*y0(1).^(-1)).^(-1).*y0(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y0(2)).^2)+((-1)+2.*y0(1).^(-1)).*( ...
  1+((-1)+3.*cos(y0(2)).^2).*((1+y0(1).^(-1)).*y0(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y0(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y0(1)).^2).^(-2).*((-5).*((-1)+y0(1))+3.*((-1)+y0(1)).^3)+ ...
  (3/2).*log(((-2)+y0(1)).^(-1).*y0(1)))))).*sin(y0(2)).^2+(-4).* ...
  y0(1).^(-2).*JJ.^2.*sin(y0(2)).^4).^(-1));

% Hamiltonian

H = @(y) (1/2)+(1/2).*(1+(-2).*y(1).^(-1)).*y(4).^2.*(1+(-2).*(1+(-2) ...
  .*y(1).^(-1)).^(-1).*y(1).^(-4).*JJ.^2+(-1).*((-1)+3.*cos(y( ...
  2)).^2).*((-6).*y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3) ...
  .*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).* ...
  ((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y( ...
  1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1))))).^(-1)+(1/2).* ...
  y(1).^(-2).*y(5).^2.*(1+(-1).*((-1)+3.*cos(y(2)).^2).*(y(1) ...
  .^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2) ...
  .^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).*log((( ...
  -2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1)+y(1)).^2).^(1/2) ...
  .*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+3.*((-1)+y(1)).^2) ...
  +(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1).*y(1))))).^(-1)+( ...
  1/2).*(LL.^2.*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4) ...
  .*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+(( ...
  -1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+( ...
  3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*(y(1).^2.*(1+(-1).*( ...
  (-1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y( ...
  1).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q) ...
  .*((-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.* ...
  ((-1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).* ...
  ((-1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).* ...
  y(1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^( ...
  -1).*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+ ...
  y(1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y( ...
  1).^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)) ...
  .*(1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+( ...
  -4).*y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1)+(-4).*y(1).^(-1) ...
  .*EE.*JJ.*LL.*sin(y(2)).^2.*(y(1).^2.*(1+(-1).*((-1)+3.*cos( ...
  y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)) ...
  .^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*((-1)+((-1) ...
  +y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y(1).^(-1) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1).*((-2)+ ...
  3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y(1)).^(-1) ...
  .*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1).^(-4).* ...
  JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*(1+((-1)+ ...
  3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+(5/8).*( ...
  (-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y( ...
  1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+(3/2).* ...
  log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).*y(1).^( ...
  -2).*JJ.^2.*sin(y(2)).^4).^(-1)+y(1).^2.*EE.^2.*(1+(-1).*(( ...
  -1)+3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1) ...
  .^(-3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1))))).*sin(y(2)).^2.*(y(1).^2.*(1+(-1).*((-1)+ ...
  3.*cos(y(2)).^2).*(y(1).^(-4).*JJ.^2+(1+y(1).^(-1)).*y(1).^( ...
  -3).*JJ.^2+(5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*(( ...
  -1).*((-1)+((-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*(( ...
  -1)+y(1)).^3)+(3/2).*log(((-2)+y(1)).^(-1).*y(1)))+(5/4).*(( ...
  -1)+((-1)+y(1)).^2).^(1/2).*(1+(-2).*y(1).^(-1)).^(-1/2).*y( ...
  1).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+y(1)).^2).^(-1) ...
  .*((-2)+3.*((-1)+y(1)).^2)+(3/2).*((-1)+y(1)).*log(((-2)+y( ...
  1)).^(-1).*y(1))))).*((-2).*(1+(-2).*y(1).^(-1)).^(-1).*y(1) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(y(2)).^2)+((-1)+2.*y(1).^(-1)).*( ...
  1+((-1)+3.*cos(y(2)).^2).*((1+y(1).^(-1)).*y(1).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+y(1)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+( ...
  (-1)+y(1)).^2).^(-2).*((-5).*((-1)+y(1))+3.*((-1)+y(1)).^3)+ ...
  (3/2).*log(((-2)+y(1)).^(-1).*y(1)))))).*sin(y(2)).^2+(-4).* ...
  y(1).^(-2).*JJ.^2.*sin(y(2)).^4).^(-1));


H0 = H(y0);

 % Butcher Table
a21=1/2; a31=0; a32=1/2; a41=0; a42=0; a43=1; a44=0; 
c1=0; c2=1/2; c3=1/2; c4=1;
b1=1/6; b2=1/3; b3=1/3; b4=1/6;

global nfs
nfs=0;
sz = size(y0);
I = eye(sz(1));
yfin=[];
t=0;
t1=[];


for i=1:N
    i

    k1=y0;
    k2=y0+h*a21*(f(k1));
    k3=y0+h*a31*(f(k1))+h*a32*(f(k2));
    k4=y0+h*a41*(f(k1))+h*a42*(f(k2))+h*a43*(f(k3));
    y1=y0+h*b1*(f(k1))+h*b2*(f(k2))+h*b3*(f(k3))+h*b4*(f(k4));

%Projection Technique applied on H

    H1 = H(y1);
    ddelH = delH(y1);
    y1 = y1 +(inv(sum(sum(ddelH.*ddelH))))*(delH(y1))*(H0-H1);

    
y0=y1;
yfin=[yfin y1];

nfs=nfs+15;

t=t+h;
t1=[t1 t];

end
yout=yfin;
tout=t1;
nfs

Hn=(1/2)+(1/2).*(1+(-2).*yout(1,:).^(-1)).*yout(4,:).^2.*(1+(-2).*(1+(-2).*yout(1,:).^(-1)).^(-1).*yout(1,:).^(-4).*JJ.^2+(-1).*((-1)+3.*cos(yout(2,:)).^2).*((-6).*yout(1,:).^(-4).*JJ.^2+(1+yout(1,:).^(-1)).*yout(1,:).^(-3) ...
  .*JJ.^2+(5/8).*((-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*((-1).* ...
  ((-1)+((-1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)).^3)+(3/2).*log(((-2)+yout(1,:)).^(-1).*yout(1,:))))).^(-1)+(1/2).* ...
  yout(1,:).^(-2).*yout(5,:).^2.*(1+(-1).*((-1)+3.*cos(yout(2,:)).^2).*(yout(1,:) ...
  .^(-4).*JJ.^2+(1+yout(1,:).^(-1)).*yout(1,:).^(-3).*JJ.^2+(5/8).*((-1)+( ...
  (-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+yout(1,:)).^2) ...
  .^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)).^3)+(3/2).*log((( ...
  -2)+yout(1,:)).^(-1).*yout(1,:)))+(5/4).*((-1)+((-1)+yout(1,:)).^2).^(1/2) ...
  .*(1+(-2).*yout(1,:).^(-1)).^(-1/2).*yout(1,:).^(-1).*((-1).*JJ.^2+q).* ...
  ((-1).*((-1)+((-1)+yout(1,:)).^2).^(-1).*((-2)+3.*((-1)+yout(1,:)).^2) ...
  +(3/2).*((-1)+yout(1,:)).*log(((-2)+yout(1,:)).^(-1).*yout(1,:))))).^(-1)+( ...
  1/2).*(LL.^2.*((-2).*(1+(-2).*yout(1,:).^(-1)).^(-1).*yout(1,:).^(-4) ...
  .*JJ.^2.*((-1)+2.*cos(yout(2,:)).^2)+((-1)+2.*yout(1,:).^(-1)).*(1+(( ...
  -1)+3.*cos(yout(2,:)).^2).*((1+yout(1,:).^(-1)).*yout(1,:).^(-3).*JJ.^2+( ...
  5/8).*((-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+(( ...
  -1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)).^3)+( ...
  3/2).*log(((-2)+yout(1,:)).^(-1).*yout(1,:)))))).*(yout(1,:).^2.*(1+(-1).*( ...
  (-1)+3.*cos(yout(2,:)).^2).*(yout(1,:).^(-4).*JJ.^2+(1+yout(1,:).^(-1)).*yout(1,:).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q) ...
  .*((-1).*((-1)+((-1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.* ...
  ((-1)+yout(1,:)).^3)+(3/2).*log(((-2)+yout(1,:)).^(-1).*yout(1,:)))+(5/4).* ...
  ((-1)+((-1)+yout(1,:)).^2).^(1/2).*(1+(-2).*yout(1,:).^(-1)).^(-1/2).* ...
  yout(1,:).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+yout(1,:)).^2).^( ...
  -1).*((-2)+3.*((-1)+yout(1,:)).^2)+(3/2).*((-1)+yout(1,:)).*log(((-2)+ ...
  yout(1,:)).^(-1).*yout(1,:))))).*((-2).*(1+(-2).*yout(1,:).^(-1)).^(-1).*yout(1,:).^(-4).*JJ.^2.*((-1)+2.*cos(yout(2,:)).^2)+((-1)+2.*yout(1,:).^(-1)) ...
  .*(1+((-1)+3.*cos(yout(2,:)).^2).*((1+yout(1,:).^(-1)).*yout(1,:).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)) ...
  .^3)+(3/2).*log(((-2)+yout(1,:)).^(-1).*yout(1,:)))))).*sin(yout(2,:)).^2+( ...
  -4).*yout(1,:).^(-2).*JJ.^2.*sin(yout(2,:)).^4).^(-1)+(-4).*yout(1,:).^(-1) ...
  .*EE.*JJ.*LL.*sin(yout(2,:)).^2.*(yout(1,:).^2.*(1+(-1).*((-1)+3.*cos(yout(2,:)).^2).*(yout(1,:).^(-4).*JJ.^2+(1+yout(1,:).^(-1)).*yout(1,:).^(-3).* ...
  JJ.^2+(5/8).*((-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*((-1).*(( ...
  -1)+((-1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)) ...
  .^3)+(3/2).*log(((-2)+yout(1,:)).^(-1).*yout(1,:)))+(5/4).*((-1)+((-1) ...
  +yout(1,:)).^2).^(1/2).*(1+(-2).*yout(1,:).^(-1)).^(-1/2).*yout(1,:).^(-1) ...
  .*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+yout(1,:)).^2).^(-1).*((-2)+ ...
  3.*((-1)+yout(1,:)).^2)+(3/2).*((-1)+yout(1,:)).*log(((-2)+yout(1,:)).^(-1) ...
  .*yout(1,:))))).*((-2).*(1+(-2).*yout(1,:).^(-1)).^(-1).*yout(1,:).^(-4).* ...
  JJ.^2.*((-1)+2.*cos(yout(2,:)).^2)+((-1)+2.*yout(1,:).^(-1)).*(1+((-1)+ ...
  3.*cos(yout(2,:)).^2).*((1+yout(1,:).^(-1)).*yout(1,:).^(-3).*JJ.^2+(5/8).*( ...
  (-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)).^3)+(3/2).* ...
  log(((-2)+yout(1,:)).^(-1).*yout(1,:)))))).*sin(yout(2,:)).^2+(-4).*yout(1,:).^(-2).*JJ.^2.*sin(yout(2,:)).^4).^(-1)+yout(1,:).^2.*EE.^2.*(1+(-1).*(( ...
  -1)+3.*cos(yout(2,:)).^2).*(yout(1,:).^(-4).*JJ.^2+(1+yout(1,:).^(-1)).*yout(1,:).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*( ...
  (-1).*((-1)+((-1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)).^3)+(3/2).*log(((-2)+yout(1,:)).^(-1).*yout(1,:)))+(5/4).*((-1)+((-1)+yout(1,:)).^2).^(1/2).*(1+(-2).*yout(1,:).^(-1)).^(-1/2).*yout(1,:).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+yout(1,:)).^2).^(-1).*((-2)+3.*((-1)+yout(1,:)).^2)+(3/2).*((-1)+yout(1,:)).*log(((-2)+yout(1,:)).^(-1).*yout(1,:))))).*sin(yout(2,:)).^2.*(yout(1,:).^2.*(1+(-1).*((-1)+ ...
  3.*cos(yout(2,:)).^2).*(yout(1,:).^(-4).*JJ.^2+(1+yout(1,:).^(-1)).*yout(1,:).^(-3).*JJ.^2+(5/8).*((-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)).^3)+(3/2).*log(((-2)+yout(1,:)).^(-1).*yout(1,:)))+(5/4).*((-1)+((-1)+yout(1,:)).^2).^(1/2).*(1+(-2).*yout(1,:).^(-1)).^(-1/2).*yout(1,:).^(-1).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+yout(1,:)).^2).^(-1).*((-2)+3.*((-1)+yout(1,:)).^2)+(3/2).*((-1)+yout(1,:)).*log(((-2)+yout(1,:)).^(-1).*yout(1,:))))).*((-2).*(1+(-2).*yout(1,:).^(-1)).^(-1).*yout(1,:) ...
  .^(-4).*JJ.^2.*((-1)+2.*cos(yout(2,:)).^2)+((-1)+2.*yout(1,:).^(-1)).*(1+((-1)+3.*cos(yout(2,:)).^2).*((1+yout(1,:).^(-1)).*yout(1,:).^(-3).*JJ.^2+ ...
  (5/8).*((-1)+((-1)+yout(1,:)).^2).*((-1).*JJ.^2+q).*((-1).*((-1)+((-1)+yout(1,:)).^2).^(-2).*((-5).*((-1)+yout(1,:))+3.*((-1)+yout(1,:)).^3)+ ...
  (3/2).*log(((-2)+yout(1,:)).^(-1).*yout(1,:)))))).*sin(yout(2,:)).^2+(-4).* ...
  yout(1,:).^(-2).*JJ.^2.*sin(yout(2,:)).^4).^(-1));

error= abs(He-Hn);

 Er=norm(He-Hn)
 
 % Extract the points when the trajectory crosses the equatorial plane ( = /2)
r_crossing = [];
p_r_crossing = [];

% Extract relevant data for Poincar surface
r = yout(1, :);      % Extract r values
th = yout(2, :);  % Extract theta values
pr = yout(4, :);    % Extract p_r values

rez=pi/2;

for i = 1:N-1
    if th(i) <= rez && th(i+1) > rez
        delta = (rez - th(i)) / (th(i+1) - th(i));
        r_value = r(i) + delta * (r(i+1) - r(i));
        p_r_value = pr(i) + delta * (pr(i+1) - pr(i));
        r_crossing = [r_crossing; r_value];
        p_r_crossing = [p_r_crossing; p_r_value];
    end
end

% Plot the Poincar surface of sections (2D plot of r vs p_r)
% figure;
% xlabel('r');
% ylabel('p_r');
% title('Poincar Surface of Sections');

% plot(r_crossing, p_r_crossing, '.')

% Save the data sets to a file
data = [r_crossing, p_r_crossing]; % Combine the r and p_r values into a matrix

filename = 'data_ProjRK34.txt'; % Specify the filename and extension
dlmwrite(filename, data, 'delimiter', '\t'); % Write the data to the file

loglog(tout,error,'color', 'blue')
set(gca,'fontsize',24)
xlabel('\tau','FontSize',24), ylabel('\DeltaH','FontSize',24) 
pbaspect([1 1 1]) % for aspect ratio
 legend('boxoff') 
leg = legend('Explicit RK','Location', 'none');
set(leg, 'Units', 'normalized', 'Position', [0.45, 0.8, 0.1, 0.1]);
set(leg, 'FontSize', 24)
dummyh = line(nan, nan, 'Linestyle', 'none', 'Marker', 'none', 'Color', 'none');
legend(dummyh, 'Explicit RK with standard projection', 'FontSize', 24)
xlim([10^-1, 5*10^5])  % Set x-axis limits 
ylim([10^-16.1, 1.4*10^-5])  % Set y-axis limits
% Customize the frame ticks

% Create tick label strings using Unicode character for multiplication
xticks([10^0, 10^1, 10^2, 10^3, 10^4, 10^5])  
 
yticks([10^-16, 10^-14, 10^-12, 10^-10, 10^-8, 10^-6])    

%xticklabels({'10^0', '10^1', '10^2', '10^3', '10^4', '10^5', '5e5'})  % Set the x-axis tick labels
%yticklabels({'10^-16', '10^-14', '10^-12', '10^-10', '10^-8', '10^-6'})



saveas(gcf, 'plot.png')

% Stop the timer
elapsedTime = toc;

% Convert the elapsed time to hours
cpuTimeHours = elapsedTime / 3600;

% Display the CPU time in hours
disp(['CPU Time: ', num2str(cpuTimeHours), ' hours'])

